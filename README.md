# simple-shop-lab

Это демонстрационный интернет-магазин на PHP и MariaDB, созданный с **намеренными** уязвимостями для образовательных целей.

**НЕ ИСПОЛЬЗУЙТЕ ЭТОТ КОД В РЕАЛЬНЫХ ПРОЕКТАХ!**

## Установка

1.  Создайте базу данных MariaDB/MySQL (например, `simple_shop_db`).
2.  Импортируйте структуру таблиц и тестовые данные из файла `setup.sql`.
3.  Настройте данные для подключения к БД в файле `db.php` (`$servername`, `$username`, `$password`, `$dbname`).
4.  Разместите все файлы на веб-сервере с поддержкой PHP (Apache + PHP, Nginx + PHP-FPM).
5.  Откройте `index.php` в браузере.

## Обнаруженные уязвимости (с примерами)

*   **Fragmented SQL Injection (process_payment.php):**
    *   **Где:** Поле "Комментарий к платежу" на странице оформления заказа (`checkout.php`).
    *   **Как:** Комментарий попадает в JSON, который затем без экранирования вставляется в SQL-запрос `INSERT INTO orders`.
    *   **Пример нагрузки:** В поле комментария ввести: `hacked", "a":"b"}', 'failed'); -- `
    *   **Результат:** Статус заказа будет установлен в `failed` вместо `paid`.

*   **IDOR (Insecure Direct Object Reference) (cart.php):**
    *   **Где:** Удаление товара из корзины и обновление количества.
    *   **Как:** Действия выполняются по `item_id` (ID записи в `cart_items`) без проверки, принадлежит ли этот ID текущей сессии пользователя.
    *   **Пример нагрузки (удаление):** Если атакующий знает `item_id=5` из чужой корзины, он может вызвать `/cart.php?action=remove&item_id=5` и удалить товар у другого пользователя.
    *   **Пример нагрузки (обновление):** Атакующий отправляет POST-запрос на `/cart.php?action=update` с параметрами `item_id=7` (из чужой корзины) и `quantity=99`, изменяя количество товара у другого пользователя.

*   **Reflected XSS (Cross-Site Scripting) (index.php):**
    *   **Где:** Параметр `error` на главной.
    *   **Как:** Значения GET-параметров выводятся на страницу без использования `htmlspecialchars()`.
    *   **Пример нагрузки:** `/index.php?error=<script>alert('XSS1')</script>`